var session_fetch=function(e,t,i){"use strict";var o={use_html5_location:!1,ipinfodb_key:!1,gapi_location:!0,location_cookie:"location",location_cookie_timeout:5,session_timeout:32,session_cookie:"first_session",get_object:null,set_object:null},r={detect:function(){var e={browser:this.search(this.data.browser),version:this.search(i.userAgent)||this.search(i.appVersion),os:this.search(this.data.os)};if("Linux"==e.os)for(var t=["CentOS","Debian","Fedora","Gentoo","Mandriva","Mageia","Red Hat","Slackware","SUSE","Turbolinux","Ubuntu"],n=0;n<t.length;n++)if(i.userAgent.toLowerCase().match(t[n].toLowerCase())){e.distro=t[n];break}return e},search:function(e){if("object"!=typeof e){var t=e.indexOf(this.version_string);if(-1==t)return;return parseFloat(e.substr(t+this.version_string.length+1))}for(var i=0;i<e.length;i++){var n=e[i].string,o=e[i].prop;if(this.version_string=e[i].versionSearch||e[i].identity,n){if(-1!=n.indexOf(e[i].subString))return e[i].identity}else if(o)return e[i].identity}},data:{browser:[{string:i.userAgent,subString:"Edge",identity:"Edge"},{string:i.userAgent,subString:"Chrome",identity:"Chrome"},{string:i.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:i.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:e.opera,identity:"Opera",versionSearch:"Version"},{string:i.vendor,subString:"iCab",identity:"iCab"},{string:i.vendor,subString:"KDE",identity:"Konqueror"},{string:i.userAgent,subString:"Firefox",identity:"Firefox"},{string:i.vendor,subString:"Camino",identity:"Camino"},{string:i.userAgent,subString:"Netscape",identity:"Netscape"},{string:i.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:i.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv"},{string:i.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:i.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:i.platform,subString:"Win",identity:"Windows"},{string:i.platform,subString:"Mac",identity:"Mac"},{string:i.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:i.userAgent,subString:"iPad",identity:"iPad"},{string:i.userAgent,subString:"Android",identity:"Android"},{string:i.platform,subString:"Linux",identity:"Linux"}]}},s={browser:function(){return r.detect()},time:function(){var e=new Date,t=new Date;return e.setMonth(0),e.setDate(1),t.setMonth(6),t.setDate(1),{tz_offset:-(new Date).getTimezoneOffset()/60,observes_dst:e.getTimezoneOffset()!==t.getTimezoneOffset()}},device:function(){var n,o,r={screen:{width:e.screen.width,height:e.screen.height}};try{n=e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth}catch(e){n=0}try{o=e.innerHeight||t.documentElement.clientHeight||t.body.clientHeight}catch(e){o=0}return r.viewport={width:n,height:o},r.is_tablet=!!i.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i),r.is_phone=!r.is_tablet&&!!i.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i),r.is_mobile=r.is_tablet||r.is_phone,r},plugins:function(){var e=function(e){if(i.plugins){for(var t,n=0,o=i.plugins.length;n<o;n++)if((t=i.plugins[n])&&t.name&&-1!==t.name.toLowerCase().indexOf(e))return!0;return!1}return!1};return{flash:e("flash")||function(e){for(var t=!0,i=0;i<e.length;i++){try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"+e[i]),t=!0}catch(e){}if(t)return!0}return!1}([".7",".6",""]),silverlight:e("silverlight"),java:e("java"),quicktime:e("quicktime")}},session:function(i,n){var o=a.get_obj(i);if(null==o){o={visits:1,start:(new Date).getTime(),last_visit:(new Date).getTime(),url:e.location.href,path:e.location.pathname,referrer:t.referrer,referrer_info:a.parse_url(t.referrer),search:{engine:null,query:null}};var r,s=[{name:"Google",host:"google",query:"q"},{name:"Bing",host:"bing.com",query:"q"},{name:"Yahoo",host:"search.yahoo",query:"p"},{name:"AOL",host:"search.aol",query:"q"},{name:"Ask",host:"ask.com",query:"q"},{name:"Baidu",host:"baidu.com",query:"wd"}],c=s.length,u=0,l="q query term p wd query text".split(" ");for(u=0;u<c;u++)if(r=s[u],-1!==o.referrer_info.host.indexOf(r.host)){o.search.engine=r.name,o.search.query=o.referrer_info.query[r.query],o.search.terms=o.search.query?o.search.query.split(" "):null;break}if(null===o.search.engine&&o.referrer_info.search.length>1)for(u=0;u<l.length;u++){var g=o.referrer_info.query[l[u]];if(g){o.search.engine="Unknown",o.search.query=g,o.search.terms=g.split(" ");break}}}else o.prev_visit=o.last_visit,o.last_visit=(new Date).getTime(),o.visits++,o.time_since_last_visit=o.last_visit-o.prev_visit;return a.set_obj(i,o,n),o},html5_location:function(){return function(e){i.geolocation.getCurrentPosition(function(t){t.source="html5",e(t)},function(t){o.gapi_location?s.gapi_location()(e):e({error:!0,source:"html5"})})}},gapi_location:function(){return function(t){var i=a.get_obj(o.location_cookie);i&&"google"===i.source?t(i):(e.gloader_ready=function(){"google"in e&&(e.google.loader.ClientLocation&&(e.google.loader.ClientLocation.source="google",t(e.google.loader.ClientLocation)),a.set_obj(o.location_cookie,e.google.loader.ClientLocation,60*o.location_cookie_timeout*60*1e3))},a.embed_script("https://www.google.com/jsapi?callback=gloader_ready"))}},architecture:function(){var e=n.userAgent.match(/x86_64|Win64|WOW64|x86-64|x64\;|AMD64|amd64/)||"x64"===n.cpuClass?"x64":"x86";return{arch:e,is_x64:"x64"==e,is_x86:"x68"==e}},ipinfodb_location:function(t){return function(i){var n=a.get_obj(o.location_cookie);n||"ipinfodb"!==n.source?i(n):(e.ipinfocb=function(e){if("OK"===e.statusCode)e.source="ipinfodb",a.set_obj(o.location_cookie,e,60*o.location_cookie*60*1e3),i(e);else{if(o.gapi_location)return s.gapi_location()(i);i({error:!0,source:"ipinfodb",message:e.statusMessage})}},a.embed_script("http://api.ipinfodb.com/v3/ip-city/?key="+t+"&format=json&callback=ipinfocb"))}}},a={parse_url:function(e){var i=t.createElement("a"),n={};i.href=e;var o=i.search.substr(1);if(""!=o)for(var r,s=o.split("&"),a=0,c=s.length;a<c;a++)2===(r=s[a].split("=")).length&&(n[r[0]]=decodeURI(r[1]));return{host:i.host,path:i.pathname,protocol:i.protocol,port:""===i.port?80:i.port,search:i.search,query:n}},set_cookie:function(i,n,o,r){return i?(r||(r={}),null!==n&&void 0!==n||(o=-1),o&&(r.expires=(new Date).getTime()+o),t.cookie=[encodeURIComponent(i),"=",encodeURIComponent(String(n)),r.expires?"; expires="+new Date(r.expires).toUTCString():"","; path="+(r.path?r.path:"/"),r.domain?"; domain="+r.domain:"",e.location&&"https:"===e.location.protocol?"; secure":""].join("")):null},get_cookie:function(e,i){return(i=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(t.cookie))?decodeURIComponent(i[1]):null},embed_script:function(e){var i=t.createElement("script");i.type="text/javascript",i.src=e,(t.body||t.getElementsByTagName("body")[0]||t.head).appendChild(i)},package_obj:function(e){if(e){e.version=.4;var t=c.stringify(e);return delete e.version,t}},set_obj:function(e,t,i,n){a.set_cookie(e,a.package_obj(t),i,n)},get_obj:function(e){var t;try{t=c.parse(a.get_cookie(e))}catch(e){}if(t&&.4==t.version)return delete t.version,t}};null!=o.get_object&&(a.get_obj=o.get_object),null!=o.set_object&&(a.set_obj=o.set_object);var c={parse:e.JSON&&e.JSON.parse||function(e){return"string"==typeof e&&e?new Function("return "+e)():null},stringify:e.JSON&&e.JSON.stringify||function(e){var t=typeof e;if("object"===t&&null!==e){var i,n,o=[],r=e&&e.constructor===Array;for(i in e)"string"===(t=typeof(n=e[i]))?n='"'+n+'"':"object"===t&&null!==n&&(n=this.stringify(n)),o.push((r?"":'"'+i+'":')+n);return(r?"[":"{")+o.join(",")+(r?"]":"}")}if("string"===t)return'"'+e+'"'}};!function(){if(e.session=e.session||{},e.session.contains=function(e){if("string"==typeof e)return-1!==this.indexOf(e);for(var t=0;t<e.length;t++)if(-1!==this.indexOf(e[t]))return!0;return!1},e.session&&e.session.options)for(var t in e.session.options)o[t]=e.session.options[t];var i={api_version:.4,current_session:s.session(),original_session:s.session(o.session_cookie,24*o.session_timeout*60*60*1e3),browser:s.browser(),plugins:s.plugins(),time:s.time(),device:s.device()};if(o.use_html5_location?i.location=s.html5_location():o.ipinfodb_key?i.location=s.ipinfodb_location(o.ipinfodb_key):o.gapi_location&&(i.location=s.gapi_location()),e.session&&e.session.start)var n=e.session.start;var r,a=0,c=function(t){t&&a--,0===a&&n&&n(e.session)};e.session={};for(var u in i)if("function"==typeof(r=i[u]))try{r(function(t){e.session[u]=t,c(!0)}),a++}catch(t){e.console&&"function"==typeof console.log&&(console.log(t),c(!0))}else e.session[u]=r;c()}()};void 0===window.exports?session_fetch(window,document,navigator):window.exports.session=session_fetch;
